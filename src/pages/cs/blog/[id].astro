---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { frontKonData } from '@/data/frontkon-data';
import type { Locale } from '@/data/types';
import { getText } from '@/utils/content';

const lang: Locale = 'cs';
const { id } = Astro.params;
const post = frontKonData.blogPosts.find((p) => p.id === id);
const author = frontKonData.speakers.find((s) => s.id === post?.authorId);
const base = import.meta.env.BASE_URL || '/';
const pref = (path: string) => `${base.replace(/\/$/, '')}${path}`;

export function getStaticPaths() {
  return frontKonData.blogPosts.map((post) => ({
    params: { id: post.id },
  }));
}

if (!post) {
  throw Astro.redirect('/cs/blog/');
}
---

<BaseLayout title={getText(post.title, lang)} lang={lang}>
  <div class="detail-page">
    <a class="back-link" href={pref('/cs/blog/')}>← Zpět na blog</a>
    <div class="detail-header">
      <h1>{getText(post.title, lang)}</h1>
      <p class="list-meta">{post.date} · {author?.name}</p>
    </div>
    <div class="detail-content">
      <p class="detail-description">{getText(post.perex, lang)}</p>
      <div class="modal-description">{post.content}</div>
    </div>
  </div>
</BaseLayout>

